<UserControl x:Class="SRKT.WPF.Views.DostepneKortyView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:converters="clr-namespace:SRKT.WPF.Converters"
             mc:Ignorable="d"
             d:DesignHeight="750" d:DesignWidth="1000">

    <UserControl.Resources>
        <converters:BoolToStatusConverter x:Key="BoolToStatusConverter"/>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#34495E"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="#ECF0F1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="White" Margin="10" CornerRadius="5" Padding="15">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
            </Border.Effect>
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="Filtry Wyszukiwania" FontSize="20" FontWeight="Bold" Margin="0,0,0,15" Foreground="#2C3E50"/>

                    <TextBlock Text="Data (wymagane):" Style="{StaticResource HeaderStyle}"/>
                    <DatePicker SelectedDate="{Binding WybranaData}" Margin="0,0,0,10" Padding="5"/>

                    <TextBlock Text="Długość gry (h):" Style="{StaticResource HeaderStyle}"/>
                    <ComboBox ItemsSource="{Binding DostepneDlugosciSesji}" 
                              SelectedItem="{Binding WybranaDlugoscSesji}"
                              Padding="5" Margin="0,0,0,10"
                              FontWeight="Bold"/>

                    <TextBlock Text="Zakres godzin:" Style="{StaticResource HeaderStyle}"/>
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding GodzinaOd}" Padding="5"/>
                        <TextBlock Grid.Column="1" Text=" - " VerticalAlignment="Center" Margin="5,0"/>
                        <TextBox Grid.Column="2" Text="{Binding GodzinaDo}" Padding="5"/>
                    </Grid>

                    <Separator Margin="0,15"/>
                    <TextBlock Text="Opcjonalne filtry kortu:" FontSize="12" Foreground="Gray" Margin="0,0,0,5"/>

                    <TextBlock Text="Obiekt sportowy:" Style="{StaticResource HeaderStyle}"/>
                    <ComboBox ItemsSource="{Binding DostepneObiekty}" SelectedItem="{Binding WybranyObiektFiltr}" DisplayMemberPath="Nazwa" Padding="5"/>
                    <Button Content="Wyczyść obiekt" Command="{Binding WyczyscFiltrObiektuCommand}" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" HorizontalAlignment="Right" FontSize="10"/>

                    <TextBlock Text="Nawierzchnia:" Style="{StaticResource HeaderStyle}"/>
                    <ComboBox ItemsSource="{Binding DostepneTypyKortu}" SelectedItem="{Binding WybranyTypKortuFiltr}" DisplayMemberPath="Nazwa" Padding="5"/>

                    <TextBlock Text="Konkretny kort:" Style="{StaticResource HeaderStyle}"/>
                    <ComboBox ItemsSource="{Binding Korty}" SelectedItem="{Binding WybranyKort}" DisplayMemberPath="Nazwa" Padding="5"/>

                    <Button Content="ODŚWIEŻ WYNIKI" Command="{Binding SzukajTerminowCommand}" 
                            Background="#2980B9" Foreground="White" FontWeight="Bold" Height="45" Margin="0,25,0,0" Cursor="Hand">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <Border Grid.Column="1" Background="White" Margin="0,10,10,10" CornerRadius="5" Padding="20">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Margin="0,0,0,15">
                    <TextBlock Text="Dostępne terminy" FontSize="22" FontWeight="Bold" Foreground="#2C3E50"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding DostepneTerminy.Count, StringFormat='Znaleziono: {0}'}" Foreground="Gray"/>
                        <TextBlock Text=" | Długość: " Foreground="Gray" Margin="5,0,0,0"/>
                        <TextBlock Text="{Binding WybranaDlugoscSesji, StringFormat='{}{0}h'}" FontWeight="Bold" Foreground="#2980B9"/>
                    </StackPanel>
                </StackPanel>

                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding DostepneTerminy}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,0,10,10" CornerRadius="5" Padding="10">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Effect">
                                                <Setter.Value>
                                                    <DropShadowEffect BlurRadius="5" ShadowDepth="1" Opacity="0.1" Color="Black"/>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Dostepny}" Value="False">
                                                    <Setter Property="Background" Value="#ECF0F1"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Dostepny}" Value="True">
                                                    <Setter Property="Background" Value="#FDFFE6"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Border Grid.Column="0" Background="#3498DB" CornerRadius="5" Padding="10" MinWidth="80">
                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding Start, StringFormat=HH:mm}" Foreground="White" FontWeight="Bold" FontSize="16" HorizontalAlignment="Center"/>
                                                <TextBlock Text="|" Foreground="White" Opacity="0.5" HorizontalAlignment="Center" FontSize="10"/>
                                                <TextBlock Text="{Binding End, StringFormat=HH:mm}" Foreground="White" FontWeight="Bold" FontSize="16" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0">
                                            <TextBlock Text="{Binding OpisKortu}" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                                <TextBlock Text="Status: " Foreground="Gray" FontSize="12"/>
                                                <TextBlock Text="{Binding Dostepny, Converter={StaticResource BoolToStatusConverter}}" 
                                                           FontWeight="Bold" FontSize="12">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Foreground" Value="#95A5A6"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Dostepny}" Value="True">
                                                                    <Setter Property="Foreground" Value="#27AE60"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </StackPanel>
                                        </StackPanel>

                                        <Button Grid.Column="2" Content="REZERWUJ" 
                                                Command="{Binding DataContext.RezerwujCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}"
                                                Background="#27AE60" Foreground="White" FontWeight="Bold" Padding="15,0" BorderThickness="0"
                                                IsEnabled="{Binding Dostepny}" Cursor="Hand" Height="40">
                                            <Button.Resources>
                                                <Style TargetType="Border">
                                                    <Setter Property="CornerRadius" Value="5"/>
                                                </Style>
                                            </Button.Resources>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <TextBlock Grid.Row="1" Text="Brak terminów dla wybranych kryteriów." 
                           VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="#BDC3C7" FontSize="18"
                           Visibility="{Binding DostepneTerminy.Count, Converter={StaticResource BoolToStatusConverter}, FallbackValue=Collapsed}"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>